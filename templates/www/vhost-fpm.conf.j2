# Automatically generated by ansible 'compose-gen' role.
# Ansible managed! Do not modify - all changed will be overwritten by playbook!

{% set sitename = site.sitename %}
server {
    set $root_path /var/www/html;
    index index.php index.html index.htm;
    disable_symlinks if_not_owner from=$root_path;
    access_log /var/www/log/nginx-access.log;
    error_log /var/www/log/nginx-error.log notice;
    ssi on;
    root $root_path;

    error_page   500 502 503 504  /50x.html;

    location = /50x.html {
        root   /usr/share/nginx/html;
    }

    location ~ /\.ht {
        access_log off;
        log_not_found off;
        deny all;
     }

    location / {
        expires           360d;
    }

    location ~* \.php$ {
        try_files $uri $uri/ /index.php last;
        fastcgi_split_path_info  (.+?\.php)(/.*)$;
        fastcgi_pass {{ sitename }}-fpm:9000;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $fastcgi_path_info;
    }
}
