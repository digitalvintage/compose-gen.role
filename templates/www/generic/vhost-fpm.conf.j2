# Automatically generated by ansible 'compose-gen' role.
# Ansible managed! Do not modify - all changed will be overwritten by playbook!

{% set sitename = item.sitename %}
server {
    set $root_path /var/www/wwwroot;
    index index.php index.html index.htm;
    disable_symlinks if_not_owner from=$root_path;
    access_log /var/www/log/nginx-access.log;
    error_log /var/www/log/nginx-error.log notice;
    ssi on;
    root $root_path;

location ~* \.php$ {
    try_files $uri $uri/ /index.php last;
    fastcgi_split_path_info  (.+?\.php)(/.*)$;
    fastcgi_pass {{ sitename }}-fpm:9000;
    fastcgi_index index.php;
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    fastcgi_param PATH_INFO $fastcgi_path_info;
    }

location ~* .php/ { rewrite  (.*.php)/ $1 last; }
}
